### 設計手法

2019年xx月xx日

---

### 前提

---
1.僕もまだまだ理解しきれてない。

2.ドメイン駆動設計や設計手法に100%の正解はない

ので、今僕はこういった考え方に基づいた設計なんだよという紹介

---

### 目次

---

---

### インプット

---

本

https://www.amazon.co.jp/%E5%AE%9F%E8%B7%B5%E3%83%89%E3%83%A1%E3%82%A4%E3%83%B3%E9%A7%86%E5%8B%95%E8%A8%AD%E8%A8%88-Object-Oriented-SELECTION-%E3%83%B4%E3%82%A1%E3%83%BC%E3%83%B3%E3%83%BB%E3%83%B4%E3%82%A1%E3%83%BC%E3%83%8E%E3%83%B3/dp/479813161X/ref=asc_df_479813161X/?tag=jpgo-22&linkCode=df0&hvadid=295706574430&hvpos=1o2&hvnetw=g&hvrand=10734808903307330717&hvpone=&hvptwo=&hvqmt=&hvdev=c&hvdvcmdl=&hvlocint=&hvlocphy=1028853&hvtargid=pla-525785668462&psc=1&th=1&psc=1
---

勉強会や色々なサイトを読み漁る

https://genbade-ddd.connpass.com/event/127494/presentation/

---

### ドメイン駆動設計で作る目的

---
ドメイン駆動設計の目的としては下記のように理解している

・ドメインに業務知識を集約する

・ソースコードを綺麗に保つ

---

### ドメインに業務知識を集約する

---

・ドメインが設計書となる

・業務知識がバラバラに記載されないため、影響反映が見えやすい

---

### ソースコードを綺麗に保つ

---

・前提としてあるのは作って終わりではなく、そのソフトウェアをどんどん成長させていく

---

### ドメインって何？

---

ドメイン

業務知識

ドメインエキスパート

ドメインを物凄く理解している人

営業、というよりか事務のお局さんとか、経理のおばちゃんとか。。。

---

### AWS

---

すみません、ここまで色々書きましたが、

何か思いつかないかなって思って書いてました。

何も思いつかないのでAWSやります！！

---

前回は基本REST API で、少しAWSに触れました。

そこで質問とかいただいて回答してる感じ

あまりピンときてないかも？

ってことでその辺やります！！

---

### スケーラブルなインフラ構成

---

前提

プログラムがあって、色々なデータを必要とするシステムとする

---
ホワイトボードの時間

①単一 EC2 インスタンス

②ロードバランサー + EC2

③ロードバランサー + EC2 + RDS


---
最初にDB周り強化していきます

④ロードバランサー + EC2 + RDS + マルチ AZ

⑤ロードバランサー + EC2 + RDS + マルチ AZ + リードレプリカ

---
ここからWebサーバ周り強化していきます

⑥ロードバランサー + オートスケーリンググループ + EC2 + RDS + マルチ AZ + リードレプリカ

---
ここで言葉の整理

スケールアップ

→能力の高いものにする

スケールダウン

→能力の低いものにする

スケールアウト

→サーバ台数増やす

スケールイン

→サーバ台数減らす

---
⑥

この子までで基本的にはよくなってきている状態だと思います。

では、例えばこのシステムがECサイトだと仮定し、テレビCMを打ちました。

どかん！とアクセスが増えました。

オートスケーリングだけだと、対応は難しいです。

何故ならば、ある程度の敷地を超えた場合に5分くらいかけてサーバを立ち上げるため

どかん！、だとサーバ立ち上がる前に死にます。

---
⑦elasticbeanstalk + ロードバランサー + オートスケーリンググループ + EC2 + RDS + マルチ AZ + リードレプリカ

ここで前も出てきたEBが出ました

この子はスケール面でも優秀で、TV CM を打つ、とわかっていれば

事前に期間限定でスケールの設定をスケジューリングすることができます

開発環境の場合、毎日定時で落として、出社時間に起動するということやって節約し始めました（お金は大事）

---

### 保守性

---

保守性ってなんだろう？

って考えた時にまずぱっと出るのが前回も出た

依存しない

というところかなと

---

さっきの①に戻る

---

### 補足

---

色々述べましたが、 + で必ずやるべきなのは

負荷試験

かなと。やるだけでは意味がなくて

どこがボトルネックでスピードが遅いのか

このくらいの負荷がかかった時にどこが最初に死ぬのか

とか調べて、修正してってPDCAサイクルを回してインフラはやった方が良さそう

---

### まとめ

---

ElasticBeanstalk
を褒めましたが、

GW中にEKS への移行を勉強 計画しようと思ってます

---

お疲れ様でした
